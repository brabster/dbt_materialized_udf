version: 2

macros:
  - name: procedure
    description: |
      A materialization for procedures as models.
      Usage example: count rows in a given relation.
      ```sql
      {{
        config(
          materialized='procedure',
          parameter_list='relation_name STRING, OUT row_count INT64',
          description='Accepts a relation name as a string and returns the row count.'
        )
      }}

      EXECUTE IMMEDIATE FORMAT("""
        SELECT COUNT(1) FROM %s
      """, relation_name)
      INTO row_count;
      ```
